<!doctype html>
<html>
  <head>
    <title>Cases</title>
    <meta charset="utf-8" />  
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="bootstrap/css/bootstrap.css" media="screen">
    <link rel="stylesheet" href="app.css" media="screen">
    <link rel="icon" type="image/x-icon" href="favicon.ico" />
   </head>
  <body>
    <div id="main-content">
      <div class="page-header">
        <h1>Cases</h1>
         <div><form class="form-inline">
          <input class="input-small search-query">
          Sort:
          <select>
            <option value="name">Name</option>
            <option value="room">Room</option>
          </select>
         </form></div>
          <div class="btn-group">
            <a class="btn" href="#"><i class="icon-plus"></i></a>
          </div>
      </div>
        <table class="table table-striped"><thead>
           <tr>
             <th>P</th>
             <th>C</th>
             <th></th>
             <th>Rm</th>
             <th>Rm#</th>
             <th>Time</th>
             <th>Pre</th>
             <th>Post</th>
             <th>Name</th>
             <th>MRN</th>
             <th>Age</th>
             <th>Procedure</th>
             <th>Surgeon</th>
             <th>Dur</th>
             <th>Anesthesia</th>
             <th>Type</th>
             <th>Case#</th>
             <th></th>
           </tr></thead>
           
           <tbody  data-bind="foreach: cases"><tr>
             <td><input type="checkbox"></td>
             <td><input type="checkbox"></td>
             <td><span data-toggle="tooltip" data-placement="top" title="" data-original-title="" class="consent-code mac-or-sedation-consent"></span></td>
             <td data-bind="text: room"></td>
             <td data-bind="text: roomNumber"></td>
             <td data-bind="text: time"></td>
             <td data-bind="text: pre"></td>
             <td data-bind="text: post"></td>
             <td data-bind="text: name"></td>
             <td data-bind="text: mrn"></td>
             <td data-bind="text: age"></td>
             <td data-bind="text: procedure"></td>
             <td data-bind="text: surgeon"></td>
             <td data-bind="text: duration"></td>
             <td data-bind="text: anesthesia"></td>
             <td data-bind="text: type"></td>
             <td data-bind="text: caseNumber"></td>
             <td>
              <div class="btn-group">
                <a class="btn" href="#"><i class="icon-edit"></i></a>
                <a class="btn" href="#"><i class="icon-trash"></i></a>
              </div>
             </td>
           </tr></tbody>
       </table>
</div>
    <script src="knockout-2.2.1.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script type="text/javascript" src="bootstrap/js/bootstrap.js"></script>
    <script type="text/javascript">
    function Case(data) {
        this.name = ko.observable(data.name);
        this.done = ko.observable(data.done);
        this.hasConsent = ko.observable(data.hasConsent);
        this.room = ko.observable(data.room);
        this.time = ko.observable(data.time);
        this.roomNumber = ko.observable(data.roomNumber);
        this.pre = ko.observable(data.pre);
        this.post = ko.observable(data.post);
        this.mrn = ko.observable(data.mrn);
        this.procedure = ko.observable(data.procedure);
        this.duration = ko.observable(data.duration);
        this.surgeon = ko.observable(data.surgen);
        this.anesthesia = ko.observable(data.anesthesia);
        this.type = ko.observable(data.type);
        this.caseNumber = ko.observable(data.caseNumber);
        this.age = ko.observable(data.age);
        this.consentGeneral = ko.observable(data.consentGeneral);
        this.consentMac = ko.observable(data.consentMac);
        this.consentConsciousSedation = ko.observable(data.consentConsciousSedation);
        this.consentRegional = ko.observable(data.consentRegional);
        this.consentSpinal = ko.observable(data.consentSpinal);
        this.consentEpidural = ko.observable(data.consentEpidural);
        this.noConsentReason = ko.observable(data.noConsentReason);
        this.noConsentNotes = ko.observable(data.noConsentNotes);
    }

  function CaseListViewModel() {
      // Data
      var self = this;
      self.cases = ko.observableArray([]);
      // Load initial state from server, convert it to Case instances, then populate self.cases
      $.getJSON("http://localhost:3000/cases", function(allData) {
          var mappedCases = $.map(allData, function(item) { return new Case(item) });
          self.cases(mappedCases);
      }); 
  }

//ko.applyBindings(new TaskListViewModel());

    ko.applyBindings({
        cases: [
    {"name": "Anders, Ann",
     "id": 1,
     "gender": "F",
     "done": false,
     "hasConsent": false,
     "room": "UF05",
     "time": "8:00",
     "pre": "IP",
     "roomNumber": "8241A",
     "post": "82SI",
     "mrn": "0203-1465",
     "procedure": "STEALTH CRANI WITH VP SHUNT REVISION",
     "duration": 90,
     "surgeon": "Davis/NOT ASSIGNED",
     "anesthesia": "",
     "type": "GEN",
     "caseNumber": 539923,
     "age": "20Y",
     "consentGeneral": false,
     "consentMac": false,
     "consentConsciousSedation": false,
     "consentRegional": false,
     "consentSpinal": false,
     "consentEpidural": false,
     "noConsentReason": " ",
     "noConsentNotes": ""
     },
    {"name": "Didley, Bo",
     "id": 2,
     "gender": "M",
     "done": false,
     "hasConsent": false,
     "room": "UA12",
     "time": "15:15",
     "pre": "IP",
     "roomNumber": "4244",
     "post": "PACU",
     "mrn": "0202-2100",
     "procedure": "G TUBE PLACEMENT",
     "duration": 45,
     "surgeon": "Stevens/Smith",
     "anesthesia": "Walters/Schmidt",
     "type": "GEN",
     "caseNumber": 5234905,
     "age": "72Y",
     "consentGeneral": false,
     "consentMac": false,
     "consentConsciousSedation": false,
     "consentRegional": false,
     "consentSpinal": false,
     "consentEpidural": false,
     "noConsentReason": " ",
     "noConsentNotes": ""
     },
    {"name": "Simpson, Homer",
     "id": 3,
     "gender": "M",
     "done": false,
     "hasConsent": false,
     "room": "UF07",
     "time": "8:00",
     "pre": "IP",
     "roomNumber": "UA6210",
     "post": "PACU",
     "mrn": "0170-8455",
     "procedure": "RIGHT FEMUR FRACTURE",
     "duration": 120,
     "surgeon": "Heisenberg/Balko",
     "anesthesia": "Payton/Robinson",
     "type": "BL/RM",
     "caseNumber": 466522,
     "age": "53Y",
     "consentGeneral": false,
     "consentMac": false,
     "consentConsciousSedation": false,
     "consentRegional": false,
     "consentSpinal": false,
     "consentEpidural": false,
     "noConsentReason": " ",
     "noConsentNotes": ""

     },
    {"name": "Smith, Judy",
     "id": 4,
     "gender": "F",
     "done": false,
     "hasConsent": false,
     "room": "GIST01",
     "time": "11:00",
     "pre": "OP",
     "roomNumber": "",
     "post": "PACU",
     "mrn": "0313-2109",
     "procedure": "EGD",
     "duration": 60,
     "surgeon": "Lasko/Jabir",
     "anesthesia": "Langley/Roberts",
     "type": "MAC",
     "caseNumber": 913456,
     "age": "2MO",
     "consentGeneral": false,
     "consentMac": false,
     "consentConsciousSedation": false,
     "consentRegional": false,
     "consentSpinal": false,
     "consentEpidural": false,
     "noConsentReason": " ",
     "noConsentNotes": ""

     }

        ]
    });

    </script>
  </body>
</html>
